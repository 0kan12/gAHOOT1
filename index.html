<script>
    document.getElementById('urlForm').addEventListener('submit', function(event) {
        event.preventDefault(); 
    
        const shortKey = document.getElementById('shortKey').value;
        const originalUrl = document.getElementById('originalUrl').value;
    
        checkAndCreateShortUrl(shortKey, originalUrl);
    });
    
    async function checkAndCreateShortUrl(shortKey, originalUrl) {
        const apiUrl = 'https://jsonblob.com/api/1195399769899261952';
    
        try {
l
            const response = await fetch(apiUrl);
            const currentData = await response.json();

            if (currentData.hasOwnProperty(shortKey)) {
                document.getElementById('resultDisplay').innerHTML = `
                    <div class="alert alert-danger">
                        Bu kısa link anahtarı zaten kullanımda.
                    </div>`;
                return;
            }
    
            currentData[shortKey] = originalUrl;
    
            const postResponse = await fetch(apiUrl, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(currentData)
            });
    
            if (postResponse.ok) {
                document.getElementById('resultDisplay').innerHTML = `
                    <div class="alert alert-success">
                        Kısa link başarıyla oluşturuldu: <a href="${shortKey}" target="_blank">url.dvtfl.xyz/${shortKey}</a>
                    </div>`;
            } else {
                document.getElementById('resultDisplay').innerHTML = `
                    <div class="alert alert-danger">
                        Veri güncelleme sırasında bir hata oluştu.
                    </div>`;
            }
        } catch (error) {
            document.getElementById('resultDisplay').innerHTML = `
                <div class="alert alert-danger">
                    Hata: ${error.message}
                </div>`;
        }
    }
    </script>
    